
# jog

  JSON logging & reporting inspired by Loggly.

## Installation

    $ npm install jog

## Features

  - namespace support
  - rich json documents
  - log levels
  - file store
  - redis store
  - document streaming
  - tail -f like streaming
  - CLI to tail and map / reduce logs

## API

### log.write(level, type[, obj])

  Write to the logs:

```js
log.write(level, type[, obj])
log.debug(type[, obj])
log.info(type[, obj])
log.warn(type[, obj])
log.error(type[, obj])
```

### log.ns(obj)

  Namespace with the given `obj`, returning a new `Jog` instance
  inheriting previous properties. You may call this several times
  to produce more and more specific loggers.

```js
var log = jog(new jog.FileStore('/tmp/log'));

// log a user 5
log = log.ns({ uid: 5 });

// log video id 99 for user 5
log = log.ns({ vid: 99 });

// or both at once
log = log.ns({ uid: 5, vid: 99 });
```

### log.stream(options)

  Return an `EventEmitter` emitting "data" and "end" events.

   - `end` when __false__ streaming will not end
   - `interval` the interval at which to poll (store-specific)

### log.clear(callback)

  Clear the logs and invoke the callback.

## Example

  Log random data using the `FileStore` and tail the file
  for changes (typically in different processes). Jog will add
  the `.level` and `.type` properties for you.

```js
var jog = require('jog')
  , log = jog(new jog.FileStore('/tmp/tail'))
  , id = 0;

// generate random log data
function again() {
  log.info('something happened', { id: ++id, user: 'Tobi' });
  setTimeout(again, Math.random() * 100 | 0);
}

again();

// tail the json "documents"
log.stream({ end: false, interval: 500 })
  .on('data', function(obj){
    console.log(obj);
  });
```

yields:

```js
{ id: 1,
  level: 'info',
  type: 'something happened',
  timestamp: 1332907641734 }
{ id: 2,
  level: 'info',
  type: 'something happened',
  timestamp: 1332907641771 }
...
```

## jog(1)

```

  Usage: jog [options]

  Options:

    -h, --help          output usage information
    -V, --version       output the version number
    -w, --within <ms>   filter events to within the given <ms>
    -t, --type <name>   filter using the given type <name>
    -l, --level <name>  filter using the given level <name>
    -f, --ignore-eof    do not stop on EOF
    -F, --file <path>   load from the given <path>
    -R, --redis         load from redis store
    -s, --select <fn>   use the given <fn> for filtering
    -m, --map <fn>      use the given <fn> for mapping
    -r, --reduce <fn>   use the given <fn> for reducing
    -c, --color         color the output
    -j, --json          output JSON (--color will not work)

```

### Examples

  View all logs from tobi. The `_` object for the function
  bodies of `--select` and `--map` represents the current
  document, it's all just javascript.

```
jog --file /tmp/jog --select "_.user == 'tobi'"
[ { user: 'tobi',
    duration: 1000,
    level: 'info',
    type: 'rendering video',
    timestamp: 1332861272100 },
  { user: 'tobi',
    duration: 2000,
    level: 'info',
